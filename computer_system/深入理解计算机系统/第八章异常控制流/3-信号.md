## 信号
信号(signal)通知进程系统中发生了某种类型的事件

* 发送信号：内核通过更新目的进程上下文中的某个状态，发送一个信号给目的进程
* 接收信号：目的进程被内核强迫以某种方式对信号的发送作出反应
* 待处理信号(pending signal)：任何时候至多只会欧一个待处理信号，待处理信号的实现是用信号掩码(signam mask)实现的，每种类型的信号只占用一个比特位

### 安全/正确/可移植信号处理
* 处理函数尽可能简单
* 处理函数只调用异步信号安全函数，即能被信号处理函数安全调用：可重入或者能被中断。如printf/malloc/exit都不是安全的。
* 保存和恢复errno，如果处理函数再次调用系统调用，可能会修改errno，需要事先保存并在退出时恢复
* 阻塞所有信号，保护共享全局结构的访问
* volatile声明全局变量，信号处理函数更新全局变量，外部可能会继续使用缓存的全局变量。volatile期望每次使用全局变量都从内存中获取
* sig_atomic_t声明标志位

* 进程只能接收一个pending的信号，后续再有相同信号，将会被丢弃，不能用信号来对发生的事件进行计数
* 正确处理竞争
* 非本地跳转，采用setjmp()/longjmp()方式进行跳转并快速恢复